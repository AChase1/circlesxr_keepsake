<html>
  <head>
    <!-- Circles' head scripts [REQUIRED] -->
    <circles-start-scripts />
    <!-- custom scripts are added here-->

    <script src="./components/circles-interactive-obj.js"></script>
    <script src="./components/pedestal-interaction.js"></script>
    <script src="./components/frame-interaction.js"></script>
    <script src="./components/gallery-name-display.js"></script>
    <script src="./components/load-artifacts.js"></script>
    <script src="./components/ui-handler.js"></script>
    <script src="./components/note-debug.js"></script>
    <script src="./components/note-creator.js"></script>
    <script src="./components/reaction-creator.js"></script>
    <script src="../Keepsake/components/interaction-manager.js"></script>
    <script src="../Keepsake/components/pickupable.js"></script>
    <script src="../Keepsake/logic/artifact.js"></script>
    <script src="../Keepsake/logic/basic.js"></script>
    <script src="../Keepsake/logic/s3.js"></script>
    <script src="../Keepsake/logic/user.js"></script>
    <script src="../Keepsake/models/artifact.js"></script>
    <script src="../Keepsake/models/all-artifacts.js"></script>


    <script src="./components/gallery-theme.js"></script>

    <script src="../Keepsake/components/select-theme.js"></script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>entering gallery...</title>
    <!-- scripts link -->

    <!-- css link -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/user-gesture.css" />
    <!-- Adding CSS for Upload UI -->

    <script>
      //Include start-experience in a-scene to run on startup
      AFRAME.registerComponent('start-experience', {
              init:function(){
                      console.log(selectedTheme); 
              }
      });
    </script>

  </head>

  <body>
    <!-- this is used to create our enter UI that creates a 2D overlay to capture a user gesture for sound/mic access etc. -->
    <circles-start-ui />

    <!-- Upload 3D UI -->
    <div id="upload-ui">
      <span id="close-btn">&times;</span>
      <div class="center">
        <h2 style="color: white">Upload to Keepsake</h2>
        <p style="color: white">Acceptable file types 3D:.glb, .gltf</p>
        <button id="upload-btn" onclick="new ArtifactLogic().getFileFromSystem()">
          Choose File
        </button>
      </div>
    </div>

      <!-- Upload 2D UI -->
    <div id="upload-2D-ui">
      <span id="close-btn-2D">&times;</span>
      <div class="center">
        <h2 style="color: white">Upload to Keepsake</h2>
        <p style="color: white">Acceptable file types 2D:.pdf</p>
        <button id="upload-btn" onclick="new FileLogic().getFileFromSystem()">
          Choose File
        </button>
      </div>
    </div>

    <!-- Upload 2D UI -->
    <div id="upload-2D-ui">
      <span id="close-btn-2D">&times;</span>
      <div class="center">
        <h2 style="color: white">Upload to Keepsake</h2>
        <p style="color: white">Acceptable file types 2D:.pdf</p>
        <button id="upload-btn" onclick="new FileLogic().getFileFromSystem()">
          Choose File
        </button>
      </div>
    </div>

    <!-- Notes UI -->
    <div id="notes-ui">
      <span id="close-btn-notes">&times;</span>
      <div class="center">
        <h2 style="color: white">Write a Note</h2>
        <textarea id="fname" name="fname" placeholder="Write your note here..."></textarea><br><br>
        <button id="confirm-btn-notes">Create Note</button>
        <p style="color: white; margin-top: 10px;">Click the note to pick it up. Click again to place it.</p>
      </div>
    </div>

    <!-- a-scene with 'circles-properties' component [REQUIRED] -->
    <a-scene
      circles_scene_properties
      interaction-manager
      gallery-name-display
      load-artifacts
      gallery-theme
    >
      <a-assets>
        <!-- put all assets here -->
        <!--Skybox-->
        <img
          id="sky_map"
          src="assets/textures/minimal_skybox.jpg"
          crossorigin="anonymous"
        />

        <!-- pedestal -->
        <a-asset-item
          id="pedestal-model"
          src="assets/models/Pedestal.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <!-- frame -->
        <a-asset-item
          id="frame-model"
          src="assets/models/Frame.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>

        <!-- minimal gallery model -->
        <a-asset-item
          id="minimal-room-model"
          src="assets/models/Minimal_Room.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>

      <!--Liminal Room Models-->
        <a-asset-item
          id="liminal-room-model"
          src="assets/models/Liminal_Room.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="liminal-room-roof"
          src="assets/models/Liminal_Room_Roof.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="lightbulb"
          src="assets/models/Lightbulb.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="foldable-chair"
          src="assets/models/Foldable_Chair.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="vent-model"
          src="assets/models/Vent.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>

        <!-- Playground Room Model -->
        <a-asset-item
          id="playground-room-model"
          src="assets/models/Playground/Playground_Room.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="playground-room-slides"
          src="assets/models/Playground Room/Slides.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="playground-room-chair-yellow"
          src="assets/models/Playground Room/Chair_Yellow.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="playground-room-chair-orange"
          src="assets/models/Playground Room/Chair_Orange.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="playground-room-chair-blue"
          src="assets/models/Playground Room/Chair_Blue.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="playground-room-chair-green"
          src="assets/models/Playground Room/Chair_Green.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="playground-room-monkeybar"
          src="assets/models/Playground Room/Monkey_Bar.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="playground-room-table"
          src="assets/models/Playground Room/Table_Yellow.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="playground-room-fence-yellow"
          src="assets/models/Playground Room/Fence_Yellow.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="playground-room-fence-red"
          src="assets/models/Playground Room/Fence_Red.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="playground-room-fence-green"
          src="assets/models/Playground Room/Fence_Green.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>

        <!-- note -->
        <a-asset-item
          id="note-model"
          src="assets/models/sticky_note.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>

        <!-- heart -->
        <a-asset-item
          id="heart-model"
          src="assets/models/heart_reaction.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>

        <!-- laugh -->
        <a-asset-item
          id="laugh-model"
          src="assets/models/laughing_reaction.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <!-- pdf model -->

        <!-- Circles' built-in assets [REQUIRED] -->
        <circles-assets />
      </a-assets>

      <!-- Circles' built-in manager and avatar [REQUIRED] -->
      <circles-manager-avatar />

      <!-- put scene stuff here -->
      <!-- camera -->
      <a-entity
        id="camera"
        camera
        look-controls
        wasd-controls
        twoway-motion="speed: 35"
        position="0 1.6 0"
        cursor="rayOrigin: mouse"
        raycaster="objects: .interactive; far: 20; interval: 100"
      >
      </a-entity>

      <a-entity
        id="sky-box"
        geometry="primitive:sphere; radius:100"
        position="0 -50 0"
        material="src: #sky_map; side:back; shader:flat"
        visible="true"
      >
      </a-entity>

      <!--MINIMAL MODELS-->
      <!--Minimal Pedestals-->
      <!-- note box -->
      <a-box 
      id="note-creator-box"
      class="interactive"
      position="1.956 1 5.312"
      rotation="0 180 0" 
      color="#FFD700"
      width="0.3"
      height="0.3"
      depth="0.1"
      note-creator
    >
      <a-text 
        value="Create Note" 
        position="0 0.25 0" 
        align="center" 
        color="#000"
        width="1"
      ></a-text>
    </a-box>

    <!-- heart -->
    <a-box 
    id="heart-reaction-box"
    class="interactive"
    reaction-creator="type: heart" 
    position="1.391 1 5.312" 
    width="0.3"
    height="0.3"
    depth="0.1"
    color="red">
  </a-box>

    <!-- laughing -->
    <a-box 
    id="laugh-reaction-box"
    class="interactive"
    reaction-creator="type: laugh" 
    position="0.948 1 5.312" 
    width="0.3"
    height="0.3"
    depth="0.1"
    color="yellow">
  </a-box>

      <!-- pedestal -->
      <a-entity
        id="minimal-pedestal-1"
        class="interactive"
        position="3.150 0 -1.822"
        rotation="0 90 0"
        scale="0.05 0.05 0.05"
        gltf-model="#pedestal-model"
        pedestal-interaction
        shadow="cast:true; receive:true;"
        visible="false"
      >
      </a-entity>

      <!-- scale="0.045 0.045 0.045"-->
      <a-entity
        id="minimal-pedestal-2"
        class="interactive"
        position="-2.87 0 -3.581"
        rotation="0 90 0"
        scale="0.045 0.045 0.045"
        gltf-model="#pedestal-model"
        pedestal-interaction
        shadow="cast:true; receive:true;"
        visible="false"
      >
      </a-entity>

      <a-entity
        id="minimal-pedestal-3"
        class="interactive"
        position="4.592 0 3.352"
        rotation="0 90 0"
        scale="0.03 0.03 0.03"
        gltf-model="#pedestal-model"
        pedestal-interaction
        shadow="cast:true; receive:true;"
        visible="false"
      >
      </a-entity>

      <!-- pdf test -->
      <a-entity id="pdf-test" position="-5.631 2.690 -1.629" rotation="0 90 0" scale="2.0 2.0 2.0" circles-pdf-loader="src:assets/pdf/bread-zine.pdf;"></a-entity>

      <!-- frame (1)-->
      <a-entity
        id="frame-1"
        class="interactive"
        position="-5.752 1.5 -1.6"
        rotation="0 90 0"
        scale="0.45 0.45 0.45"
        gltf-model="#frame-model"
        frame-interaction
        shadow="cast:true; receive:true;"
      >
      </a-entity>

      <!-- frame (2)-->
      <a-entity
        id="frame-2"
        class="interactive"
        position="1 1.7 -5.787"
        rotation="0 0 0"
        scale="0.45 0.45 0.45"
        gltf-model="#frame-model"
        frame-interaction
        shadow="cast:true; receive:true;"
      >
      </a-entity>

      <!-- frame (3)-->
      <a-entity
        id="frame-3"
        class="interactive"
        position="5.754 1 0.04"
        rotation="0 -90 0"
        scale="0.45 0.45 0.45"
        gltf-model="#frame-model"
        frame-interaction
        shadow="cast:true; recieve:true;"
      >
      </a-entity>

      <!-- Minimal Room -->
      <a-entity
        id="minimal-room"
        class="minimal-room"
        position="0 0 0"
        rotation="0 0 0"
        scale="0.23 0.23 0.23"
        gltf-model="#minimal-room-model"
        shadow="receive:true; cast:false;"
        visible="false"
      >
      </a-entity>

      <!--Minimal Light-->
      <!--NOTE: Need to be repaired-->
      <a-entity light="type: ambient"
        class="minimal-room"
        visible="false"
      ></a-entity>

      <!--LIMINAL MODELS-->
      <!--Liminal Room -->
      <a-entity
        id="limimal-room"
        class="limimal-room"
        position="0 0 0"
        rotation="0 -90 0"
        scale="0.23 0.23 0.23"
        gltf-model="#liminal-room-model"
        shadow="receive:false; cast:false;"
        visible="false"
      >
      </a-entity>

      <!--Liminal Roof-->
      <a-entity
        id="limimal-roof"
        class="limimal-room"
        position="0 0.023 0"
        rotation="0 0 0"
        scale="0.23 0.23 0.23"
        gltf-model="#liminal-room-roof"
        shadow="receive:false; cast:false;"
        visible="false"
      >
      </a-entity>

      <!--Liminal Vents-->
      <a-entity
        id="vent1"
        class="limimal-room"
        position="-5.734 1.263 1.674"
        rotation="0 0 0"
        scale="0.155 0.155 0.155"
        gltf-model="#vent-model"
        shadow="receive:false; cast:false;"
        visible="false"
      >
      </a-entity>
      <a-entity
        id="vent2"
        class="limimal-room"
        position="5.779 0.336 -3.157"
        rotation="0 -180 0"
        scale="0.134 0.134 0.134"
        gltf-model="#vent-model"
        shadow="receive:false; cast:false;"
        visible="false"
      >
      </a-entity>

      <!--Liminal Lightbulb-->
      <a-entity
        id="lightbulb"
        class="limimal-room"
        position="-3.240 0.116 3.625"
        rotation="0 0 0"
        scale="0.134 0.134 0.134"
        gltf-model="#lightbulb"
        shadow="receive:false; cast:false;"
        visible="false"
      >
      </a-entity>

      <!--Liminal Point Light-->
      <a-entity light="type: point;
                      intensity: 7;
                      color: #dedbba"
        position="-2.946 4.009 3.413"
        class="limimal-room"
        visible="false"
        ></a-entity>

      <!--Liminal Chair Pedestals-->
      <a-entity
        id="liminal-pedestal-1"
        class="liminal-room interactive"
        position="1.712 0 -2.357"
        rotation="0 -145.028 0"
        scale="0.076 0.076 0.076"
        gltf-model="#foldable-chair"
        pedestal-interaction
        shadow="cast:true; receive:true;"
        visible="false"
      >
      </a-entity>
      <a-entity
        id="liminal-pedestal-2"
        class="liminal-room interactive"
        position="-3.753 0 -2.885"
        rotation="0 -30.434 0"
        scale="0.076 0.076 0.076"
        gltf-model="#foldable-chair"
        pedestal-interaction
        shadow="cast:true; receive:true;"
        visible="false"
      >
      </a-entity>
      <a-entity
        id="liminal-pedestal-3"
        class="liminal-room interactive"
        position="3.500 0 2.650"
        rotation="0 117.182 0"
        scale="0.076 0.076 0.076"
        gltf-model="#foldable-chair"
        pedestal-interaction
        shadow="cast:true; receive:true;"
        visible="false"
      >
      </a-entity>

      <!--Playground Room-->
      <a-entity
        id="playground-room"
        class="playground-room"
        position="0 0 0"
        rotation="0 -90 0"
        scale="0.23 0.23 0.23"
        gltf-model="#playground-room-model"
        shadow="receive:false; cast:false;"
        visible="true"
      ></a-entity>

      <a-entity
        id="playground-room-slides"
        class="playground-room"
        position="-2.35 0 -4.1"
        rotation="0 0 0"
        scale="0.32 0.32 0.32"
        gltf-model="#playground-room-slides"
        shadow="receive:true; cast:false;"
        visible="true"
      ></a-entity>

      <a-entity
        id="playground-room-monkeybar"
        class="playground-room"
        position="3.8 0 2.84"
        rotation="0 90 0"
        scale="0.4 0.4 0.4"
        gltf-model="#playground-room-monkeybar"
        shadow="receive:true; cast:false;"
        visible="true"
      ></a-entity>

      <a-entity
        id="playground-pedastal-1"
        class="playground-room"
        position="0 0 0"
        rotation="0 0 0"
        scale="0.32 0.32 0.32"
        gltf-model="#playground-room-chair-blue"
        shadow="receive:false; cast:false;"
        visible="true"
      ></a-entity>

      <a-entity
        id="playground-pedestal-2"
        class="playground-room"
        position="1 0 2"
        rotation="0 0 0"
        scale="0.32 0.32 0.32"
        gltf-model="#playground-room-chair-green"
        shadow="receive:true; cast:false;"
        visible="true"
      ></a-entity>

      <a-entity
        id="playground-pedestal-3"
        class="playground-room"
        position="4 0 6"
        rotation="0 0 0"
        scale="0.32 0.32 0.32"
        gltf-model="#playground-room-chair-yellow"
        shadow="receive:true; cast:false;"
        visible="true"
      ></a-entity>

      

      <a-entity light="type: point;
                      intensity: 7;
                      color: #dedbba"
        position="-2.946 4.009 3.413"
        class="playground-room"
        visible="true"
      ></a-entity>

      <!-- EXIT: back to lobby portal -->
      <a-entity
        id="portal_link"
        position="-4.573 1.347 4.479"
        rotation="0 143.672 0"
        scale="1 1 1"
        circles-portal="title_text:Exit to Lobby; link_url:/w/Keepsake?gallerySource=true"
      ></a-entity>
    </a-scene>

    <!-- Circles' end scripts [REQUIRED] -->
    <circles-end-scripts />
  </body>
</html>
