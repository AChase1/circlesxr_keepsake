<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Circles' head scripts [REQUIRED] -->
    <circles-start-scripts/>
    <!-- Physics script goes after the Circles' head scripts [IMPORTANT]-->
    <script src="/global/js/libs/aframe-physics-system.min.js"></script>
    <script src="/worlds/KIN_FreeFall/components/physics-object.js"></script>
    <script src="/worlds/KIN_FreeFall/components/collision-indicator.js"></script>
    <script src="/worlds/KIN_FreeFall/scripts/experiment-functions.js"></script>
  </head>

  <body onload="setup()">
    <!-- a-scene with 'circles-properties' component [REQUIRED] -->
    <a-scene circles_properties physics="debug: true; gravity: -9.8;" background="color:#0476D9;" shadow="type: pcfsoft"  fog="type: linear; color: #0482d1; far: 30; near: 0">

      <a-camera position="0 1.4 3" rotation="-1 0 0"></a-camera>
      <!-- assets -->
      <a-assets timeout="10000">

        <!-- GLTF Models -->
        <a-asset-item id="Ball-gltf" src="/worlds/KIN_FreeFall/assets/models/Ball.glb"></a-asset-item>
        <a-asset-item id="Bear-gltf" src="/worlds/KIN_FreeFall/assets/models/Bear.glb"></a-asset-item>
        <a-asset-item id="Car-gltf" src="/worlds/KIN_FreeFall/assets/models/Drill.glb"></a-asset-item>
        <a-asset-item id="Hand-gltf" src="/worlds/KIN_FreeFall/assets/models/Hand.glb"></a-asset-item>
        <a-asset-item id="Counter-gltf" src="/worlds/KIN_FreeFall/assets/models/Counter.glb"></a-asset-item>

        <!-- Circles' built-in assets [REQUIRED] -->
        <circles-assets/>
      </a-assets>

      <!-- Circles' built-in avatar [REQUIRED] -->
      <circles-avatar/>

      <!-- Experiment Objects -->
      <a-entity gltf-model="#Ball-gltf" id="leftObject" physics-object="initialPosition: -1.745 4 -7; mass: 0.3;"></a-entity>
      <a-entity gltf-model="#Ball-gltf" id="rightObject" physics-object="initialPosition: 1.843 4 -7; mass: 0.3;"></a-entity>

      <!-- Control station Text -->
      <a-entity id="TitleText" text="value: FREE FALL; color: white; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: /worlds/KIN_FreeFall/assets/font/BebasNeue-Regular-msdf.json; negate: false; lineHeight: 60" scale="1.7 1.7 1.7" position="0.01432 1.15448 -2.96097" rotation="-29.999999999999996 0 0"></a-entity>
      <a-entity id="StartText" text="value: START; color: #024975; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: /worlds/KIN_FreeFall/assets/font/Nunito-Bold-msdf.json; negate: false; lineHeight: 60" scale="1.0 1.0 1.0" position="0.255 0.929 -2.841" rotation="-29.999999999999996 0 0"></a-entity>
      <a-entity id="ResetText" text="value: RESET; color: #024975; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: /worlds/KIN_FreeFall/assets/font/Nunito-Bold-msdf.json; negate: false; lineHeight: 60" scale="1.0 1.0 1.0" position="-0.255 0.929 -2.841" rotation="-29.999999999999996 0 0"></a-entity>
      <a-entity id="IncreaseGravityText" text="value: INCREASE GRAVITY; color: #024975; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: /worlds/KIN_FreeFall/assets/font/Nunito-Bold-msdf.json; negate: false; lineHeight: 60" scale="0.5 0.5 0.5" position="0.27392 1.60667 -3.26338" rotation="-29.999999999999996 0 0"></a-entity>
      <a-entity id="DecreaseGravityText" text="value: DECREASE GRAVITY; color: #024975; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: /worlds/KIN_FreeFall/assets/font/Nunito-Bold-msdf.json; negate: false; lineHeight: 60" scale="0.5 0.5 0.5" position="-0.25562 1.607 -3.263" rotation="-29.999999999999996 0 0"></a-entity>
      <a-entity id="Bear" text="value: BALL; color: #024975; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: /worlds/KIN_FreeFall/assets/font/Nunito-Bold-msdf.json; negate: false; lineHeight: 60" scale="0.5 0.5 0.5" position="-1.00204 1.607 -3.263" rotation="-29.999999999999996 0 0"></a-entity>
      <a-entity id="Obj2Text" text="value: BEAR; color: #024975; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: /worlds/KIN_FreeFall/assets/font/Nunito-Bold-msdf.json; negate: false; lineHeight: 60" scale="0.5 0.5 0.5" position="-1.00381 1.20034 -3.02957" rotation="-29.999999999999996 0 0"></a-entity>
      <a-entity id="Obj3Text" text="value: CAR; color: #024975; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: /worlds/KIN_FreeFall/assets/font/Nunito-Bold-msdf.json; negate: false; lineHeight: 60" scale="0.5 0.5 0.5" position="-1.00344 0.81033 -2.80181" rotation="-29.999999999999996 0 0"></a-entity>
      <a-entity id="Bear" text="value: BALL; color: #024975; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: /worlds/KIN_FreeFall/assets/font/Nunito-Bold-msdf.json; negate: false; lineHeight: 60" scale="0.5 0.5 0.5" position="1.00204 1.607 -3.263" rotation="-29.999999999999996 0 0"></a-entity>
      <a-entity id="Obj2Text" text="value: BEAR; color: #024975; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: /worlds/KIN_FreeFall/assets/font/Nunito-Bold-msdf.json; negate: false; lineHeight: 60" scale="0.5 0.5 0.5" position="1.00381 1.20034 -3.02957" rotation="-29.999999999999996 0 0"></a-entity>
      <a-entity id="Obj3Text" text="value: CAR; color: #024975; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: /worlds/KIN_FreeFall/assets/font/Nunito-Bold-msdf.json; negate: false; lineHeight: 60" scale="0.5 0.5 0.5" position="1.00344 0.81033 -2.80181" rotation="-29.999999999999996 0 0"></a-entity>

      <!-- Control station -->
      <a-entity id="controlStation1" geometry="width: 5; height: 3" material="side: double; color: #025d96" position="0 1.018 -2.999" rotation="-29.999999999999996 0 0" scale="0.51 0.54 0.13"></a-entity>
      <a-entity id="controlStation" geometry="primitive: plane; width:5; height:3;" material="side: double; color: #025d96;" position="0 0.995 -2.951" rotation="-30 0 0" scale="0.5 0.5 0.5">
        <a-entity id="controlStationButtons" rotation="90 0 0">
          <!-- Experiment control buttons -->
          <a-entity id="startButtonGroup" position="0.5 0.1 0.9" scale="1.5 1.5 1.5">
            <a-entity id="startButton" onclick="startExperiment()" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)"></a-entity>
            <!--<a-entity text="value: Start; align: center; color: white;" scale="2.5 2.5 2.5" position="0 0 -0.4" rotation="-90 0 0"></a-entity>-->
          </a-entity>

          <a-entity id="resetButtonGroup" position="-0.5 0.1 0.9" scale="1.5 1.5 1.5">
            <a-entity id="resetButton" onclick="resetExperiment()" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)"></a-entity>
            <!--<a-entity text="value: Reset; align: center;" scale="2.5 2.5 2.5" position="0 0 -0.4" rotation="-90 0 0"></a-entity>-->
          </a-entity>

          <!-- Gravity control buttons -->
          <a-entity id="gravityIncreaseButtonGroup" position="0.5 0.1 -0.9">
            <a-entity id="gravityIncreaseButton" onclick="increaseGravity()" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)"></a-entity>
            <!--<a-entity text="value: Increase Gravity; align: center;" scale="2.5 2.5 2.5" position="0 0 -0.4" rotation="-90 0 0"></a-entity>-->
          </a-entity>

          <a-entity id="gravityDecreaseButtonGroup" position="-0.5 0.1 -0.9">
            <a-entity id="gravityDecreaseButton" onclick="decreaseGravity()" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)"></a-entity>
            <!--<a-entity text="value: Decrease Gravity; align: center;" scale="2.5 2.5 2.5" position="0 0 -0.4" rotation="-90 0 0"></a-entity>-->
          </a-entity>

          <!-- Left object switching buttons -->
          <a-entity id="leftObject1ButtonGroup" position="-2 0.1 -0.9">
            <a-entity id="leftObject1Button" onclick="setNewObject('object1', 'left')" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)"></a-entity>
            <!--<a-entity text="value: Object 1; align: center;" scale="2.5 2.5 2.5" position="0 0 -0.4" rotation="-90 0 0"></a-entity>-->
          </a-entity>

          <a-entity id="leftObject2ButtonGroup" position="-2 0.1 0">
            <a-entity id="leftObject2Button" onclick="setNewObject('object2', 'left')" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)"></a-entity>
            <!--<a-entity text="value: Object 2; align: center;" scale="2.5 2.5 2.5" position="0 0 -0.4" rotation="-90 0 0"></a-entity>-->
          </a-entity>

          <a-entity id="leftObject3ButtonGroup" position="-2 0.1 0.9">
            <a-entity id="leftObject3Button" onclick="setNewObject('object3', 'left')" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)"></a-entity>
            <!--<a-entity text="value: Object 3; align: center;" scale="2.5 2.5 2.5" position="0 0 -0.4" rotation="-90 0 0"></a-entity>-->
          </a-entity>

          <!-- Right object switching buttons -->
          <a-entity id="rightObject1ButtonGroup" position="2 0.1 -0.9">
            <a-entity id="rightObject1Button" onclick="setNewObject('object1', 'right')" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)"></a-entity>
            <!--<a-entity text="value: Object 1; align: center;" scale="2.5 2.5 2.5" position="0 0 -0.4" rotation="-90 0 0"></a-entity>-->
          </a-entity>

          <a-entity id="rightObject2ButtonGroup" position="2 0.1 0">
            <a-entity id="rightObject2Button" onclick="setNewObject('object2', 'right')" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)"></a-entity>
            <!--<a-entity text="value: Object 2; align: center;" scale="2.5 2.5 2.5" position="0 0 -0.4" rotation="-90 0 0"></a-entity>-->
          </a-entity>

          <a-entity id="rightObject3ButtonGroup" position="2 0.1 0.9">
            <a-entity id="rightObject3Button" onclick="setNewObject('object3', 'right')" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)"></a-entity>
            <!--<a-entity text="value: Object 3; align: center;" scale="2.5 2.5 2.5" position="0 0 -0.4" rotation="-90 0 0"></a-entity>-->
          </a-entity>
        </a-entity>

        <a-entity id="controlStationUI" rotation="90 0 0">
          <a-entity id="gravityStrengthText" text="value: Current Gravity: 1g; align: center;" position="0 0 -0.4" rotation="-90 0 0" scale="2.5 2.5 2.5"></a-entity>
        </a-entity>
      </a-entity>

      <!-- Experiment indicators -->
      <a-entity id="leftCollisionIndicator" collision-indicator position="-3.3 0.5 -5.5" scale="0.7 0.7 0.7"></a-entity>
      <a-entity id="rightCollisionIndicator" collision-indicator position="3.5 0.5 -5.5" scale="0.7 0.7 0.7"></a-entity>

      <!-- Floor -->
      <!-- We use a box and not a plane because the hitbox of the plane is not 100% tight around it. This caused an issue where the objects would not hit the floor, but rather would just float. -->
      <a-box position="0 -0.5 0" height="30" width="30" depth="1" rotation="-90 0 0" color="#047cc7" static-body="shape: plane;" circles-shadow></a-box>

      <!-- Hand Model -->
      <a-entity id="hand1" gltf-model="#Hand-gltf" scale="0.3 0.3 0.3" position="-2.5 4.8 -7.1" rotation="-9 -3 -64"></a-entity>
      <a-entity id="hand2" gltf-model="#Hand-gltf" scale="-0.3 -0.3 -0.3" position="2.7 4.8 -7.1" rotation="-0.89 -179.66 -239.99999999999997"></a-entity>
      
      <!-- Lab Counters-->
      <a-entity id="Counter1" gltf-model="#Counter-gltf" scale="0.43783 0.43783 0.43783" position="-4.82469 0.55975 -7.13517" rotation="0 180 0"></a-entity>
      <a-entity id="Counter2" gltf-model="#Counter-gltf" scale="-0.438 0.43783 0.43783" position="4.825 0.55975 -7.13517" rotation="0 180 0"></a-entity>
      <a-entity id="Counter3" gltf-model="#Counter-gltf" scale="-0.438 0.43783 0.43783" position="-0.45572 0.55975 -11.05981" rotation="0 270 0"></a-entity>
      <a-entity id="Counter-Bear" gltf-model="#Bear-gltf" scale="-0.126 0.12629 0.12629" position="-4.57595 2.03556 -5.80507" rotation="0 220.33 0"></a-entity>
    </a-scene>

    <!-- Circles' end scripts [REQUIRED] -->
    <circles-end-scripts/>
  </body>
</html>
