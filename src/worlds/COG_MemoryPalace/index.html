<html>
  <head>
    <meta charset="utf-8">

    <!-- Circles' head scripts [REQUIRED] -->
    <circles-start-scripts/>

    <!-- add your custom scripts here -->
    <!-- <script src="/worlds/hub/scripts/hub.js"></script> -->
    <!-- <script src="/worlds/COG_MemoryPalace/Scripts/animation-mixer.js" response-type="arraybuffer" crossorigin="anonymous"></script> -->
    <!-- <script src="/global/js/libs/aframe-extras.animation-mixer.js"></script> -->
    <script src="/worlds/COG_MemoryPalace/components/look-at.js"></script>
  </head>
  <body>

    <!-- this is used to create our enter UI that creates a 2D overlay to capture a user gesture for sound/mic access etc. -->
    <circles-start-ui/>

    <!-- a-scene with 'circles-properties' component [REQUIRED] -->
    <a-scene circles_scene_properties>
      <a-assets>
        <!-- add your assets here -->
        <!-- credit: HDRMaps @ https://hdrmaps.com/above-the-clouds/ -->
        <img id="skyMap" src="/worlds/COG_MemoryPalace/assets/images/086_hdrmaps_com_free_above_clouds.jpg" crossorigin="anonymous">
        <!-- Images -->
        <img id="banana-img" src="/worlds/COG_MemoryPalace/assets/images/banana.jpeg" crossorigin="anonymous">

        <!-- gltf models -->
        <!-- credits [a mix of custom models and the [editted] models listed below]:  -->
        <!-- Emiel @ https://sketchfab.com/3d-models/stylized-assets-7c180198693542a49fb39c8f81af14fd -->
        <!-- Glezova @ https://sketchfab.com/3d-models/stylized-bridge-dea55cb580e44d458e84d4455eda5de8 -->
        <!-- Sereda @ https://sketchfab.com/3d-models/stylized-stones-minipack-719d8ee393db4b218ace19ce9124918d -->
        <!-- Satendra Saraswat @ https://sketchfab.com/3d-models/stylized-hand-painted-tree-f4e3fe276aca48d09d312b6dae100bce -->

        <!-- Islands -->
        <a-asset-item id="island_placeholder_gltf"  src="/worlds/COG_MemoryPalace/assets/models/island_1/scene.gltf" response-type="arraybuffer" crossorigin="anonymous"></a-asset-item>
        <a-asset-item id="island_1_gltf"  src="/worlds/COG_MemoryPalace/assets/models/Island1.glb" response-type="arraybuffer" crossorigin="anonymous"></a-asset-item>

        <!-- loading navmesh. Following instructiosn from here: https://github.com/n5ro/aframe-extras/tree/master/src/pathfinding -->
        <a-asset-item id="navmesh_gltf" src="/worlds/ExampleWorld/assets/models/navmesh.glb" response-type="arraybuffer" crossorigin="anonymous"></a-asset-item>

        <a-asset-item id="spinal-cord-gltf" src="/worlds/COG_MemoryPalace/assets/models/island_1/SpinalCord.glb" response-type="arraybuffer" crossorigin="anonymous"></a-asset-item>

        <!-- Circles' built-in assets [REQUIRED] -->
        <circles-assets/>
      </a-assets>

      <!-- Circles' built-in manager and avatar [REQUIRED] -->
      <circles-manager-avatar/>

      <!-- islands, with some spawnpoints -->
      <a-entity id="env_group" position="0 0 20">
        <!-- Environment -->

        <!-- ISLAND 1 -->
        <a-entity id="island_1_group">
          <a-entity id="island_1" position="-17 0.75 33" rotation="0 0 0" scale="1 1 1" gltf-model="#island_1_gltf" circles-sphere-env-map="src:#skyMap" shadow="cast:false; receive:true;"></a-entity>
          <a-entity id="spine" position="-17 1 36" scale="0.5 0.5 0.5" gltf-model="#spinal-cord-gltf" animation-mixer></a-entity>
        </a-entity>

        <a-entity id="island_2" position="-30 6 13" rotation="0 0 0" scale="3 3 3" gltf-model="#island_placeholder_gltf" circles-sphere-env-map="src:#skyMap" shadow="cast:false; receive:true;"></a-entity>
        <a-entity id="island_3" position="5 12 -1" rotation="0 -50 0" scale="2 2 2" gltf-model="#island_placeholder_gltf" circles-sphere-env-map="src:#skyMap" shadow="cast:false; receive:true;"></a-entity>
        <a-entity id="island_4" position="9 10 -30" rotation="0 -25 0" scale="2.4 2.4 2.4" gltf-model="#island_placeholder_gltf" circles-sphere-env-map="src:#skyMap" shadow="cast:false; receive:true;"></a-entity>
        <a-entity id="island_5" position="23 27 -52" rotation="0 115 0" scale="2.7 2.7 2.7" gltf-model="#island_placeholder_gltf" circles-sphere-env-map="src:#skyMap" shadow="cast:false; receive:true;"></a-entity>
        <a-entity id="island_6" position="-6.6 26 -70" rotation="0 80 0" scale="2.7 2.7 2.7" gltf-model="#island_placeholder_gltf" circles-sphere-env-map="src:#skyMap" shadow="cast:false; receive:true;"></a-entity>

        <a-entity id="island_1_checkpoint_1" circles-checkpoint circles-spawnpoint position="-18 0.6 33"></a-entity>
        <a-entity id="island_2_checkpoint_1" circles-checkpoint position="-26.4 7.37 21.65"></a-entity>

        <!-- button that we will use to "teleport" to far off places (i.e., door-to-door in this world) -->
        <a-entity id="island_1_button_1" circles-button="pedastal_color:rgb(74, 87, 95);" circles-sendpoint="target:#island_2_checkpoint_1;" position="-19 0.86 32" rotation="0 0 -90" scale="0.8 0.8 0.8"></a-entity>
        <a-entity id="island_2_button_1" circles-button="pedastal_color:rgb(74, 87, 95);" circles-sendpoint="target:#island_1_checkpoint_1;" position="-24 8.0 19.5" rotation="0 155 -55" scale="0.8 0.8 0.8"></a-entity>
        <a-entity id="island_2_button_2" circles-button="pedastal_color:rgb(74, 87, 95);" circles-sendpoint="target:#island_1_button_1;" position="-24.3 8.3 8.2" rotation="4 167 1.6" scale="0.8 0.8 0.8"></a-entity>
      </a-entity>

      <!-- <a-entity id="navmesh" gltf-model="#navmesh_gltf" visible='false' nav-mesh></a-entity> -->

      <!-- Image plane -->
      <a-image id="banana-img-plane" src="#banana-img" position="-17 2 50" look-at="#Player1"></a-image>

      <!-- sky and lights -->
      <a-entity id="sunlight" position="0 20 0" rotation="40 0 0"
                light="type:directional; intensity:4; color:#d5e4f5; castShadow:false;"></a-entity>
      <a-entity light="type:hemisphere; color:#FFFFFF; groundColor:#BCE2F4; intensity:3.0"></a-entity>

      <a-entity id="skyBox"
                rotation="0 200 0"
                scale="5 5 5"
                geometry="primitive:sphere; radius:50; segments-height:24; segments-width:24;"
                material="shader:flat; src:#skyMap; side:back;">
      </a-entity>
    </a-scene>

    <!-- Circles' end scripts [REQUIRED] -->
    <circles-end-scripts/>
  </body>
</html>
