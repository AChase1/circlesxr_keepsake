<html>
  <head>
    <!-- Circles' head scripts [REQUIRED] -->
    <circles-start-scripts />
    <!-- custom scripts are added here-->
    <script src="./components/circles-pickup-object.js"></script>
    <script src="./components/pickupable.js"></script>
    <script src="./components/plate-interaction.js"></script>
    <script src="./components/object-label.js"></script>
    <script src="./components/tutorial.js"></script>
    <script src="./components/select-theme.js"></script>

    <script src="./components/interaction-manager.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-blink-controls/dist/aframe-blink-controls.min.js"></script>

    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.4/dist/aframe-extras.min.js"></script>
    <script src="./components/orbs.js"></script>

    <script src="./logic/artifact.js"></script>
    <script src="./logic/basic.js"></script>
    <script src="./logic/s3.js"></script>
    <script src="./logic/user.js"></script>

    <script src="./models/artifact.js"></script>
    <script src="./models/orb.js"></script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Keepsake</title>
    <!-- scripts link -->

    <!-- css link -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/user-gesture.css" />
  </head>

  <body>
    <!-- this is used to create our enter UI that creates a 2D overlay to capture a user gesture for sound/mic access etc. -->
    <circles-start-ui />

    <!-- Upload UI -->
    <div id="upload-ui">
      <span id="close-btn">&times;</span>
      <div class="center">
        <h2 style="color: white">Upload a Keepsake</h2>
        <p style="color: white">Acceptable file types 3D:.glb, .gltf</p>
        <button id="upload-btn" onclick="new FileLogic().getFileFromSystem()">
          Choose File
        </button>
        <input
          type="file"
          id="file-input"
          style="display: none"
          accept=".glb,.gltf"
        />
      </div>
    </div>

    <!-- Orb Label UI-->
    <div id="label-ui">
      <span id="close-label-btn">&times;</span>
      <div class="label-content">
        <h2>Name Your Orb</h2>
        <input type="text" id="label-input" placeholder="Enter a name..." />
      </div>
      <div class="label-buttons">
        <button id="cancel-label" class="label-btn">Cancel</button>
        <button id="submit-label" class="label-btn">Submit</button>
      </div>
    </div>

    <!-- a-scene with 'circles-properties' component [REQUIRED] -->
    <a-scene
      circles_scene_properties
      interaction-manager
      orbs
      background="color: black"
    >
      <a-assets>
        <!-- put all assets here -->

        <!--Skybox Image-->
        <img
          id="sky_map"
          src="assets/images/resting_place.jpg"
          crossorigin="anonymous"
        />

        <!-- pedestal -->
        <a-asset-item
          id="pedestal-model"
          src="assets/models/doric_twist_pedestal.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>

        <a-asset-item
          id="chair-model"
          response-type="arraybuffer"
          src="./assets/models/Chair_BaseColor.glb"
        ></a-asset-item>
        <a-asset-item
          id="table-model"
          response-type="arraybuffer"
          src="./assets/models/Table_BaseColor.glb"
        ></a-asset-item>
        <a-asset-item
          id="reception-desk-model"
          response-type="arraybuffer"
          src="./assets/models/Desk_Keepsake.glb"
        ></a-asset-item>

        <!--Computer Models-->
        <a-asset-item
          id="computer-minimal"
          response-type="arraybuffer"
          src="./assets/models/Computer_Minimal.glb"
        ></a-asset-item>
        <a-asset-item
          id="computer-playground"
          response-type="arraybuffer"
          src="./assets/models/Computer_Playground.glb"
        ></a-asset-item>
        <a-asset-item
          id="computer-liminal"
          response-type="arraybuffer"
          src="./assets/models/Computer_Liminal.glb"
        ></a-asset-item>
        <a-asset-item
          id="computer-nature"
          response-type="arraybuffer"
          src="./assets/models/Computer_Nature.glb"
        ></a-asset-item>

        <!--Speech Bubble-->
        <a-asset-item
          id="speech-bubble"
          response-type="arraybuffer"
          src="./assets/models/Speech_Bubble.glb"
        ></a-asset-item>

        <!--Receptionist-->
        <a-asset-item
          id="receptionist"
          response-type="arraybuffer"
          src="./assets/models/Receptionist.glb"
        ></a-asset-item>

        <!--Lobby Model-->
        <a-asset-item
          id="orb-room-model"
          src="assets/models/Lobby_BaseColor.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>

        <!--Lobby NavMesh-->
        <a-asset-item
          id="lobby-navmesh"
          src="assets/models/Lobby_NavMesh.glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>

        <!-- polycam scans -->
        <a-asset-item
          id="owl-model"
          src="assets/models/Owl Puppet (1).glb"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>

        <!-- Circles' built-in assets [REQUIRED] -->
        <circles-assets />
      </a-assets>

      <!-- Circles' built-in manager and avatar [REQUIRED] -->
      <circles-manager-avatar />

      <!-- put scene stuff here -->

      <!-- Camera -->
       <!--Camera is now inside of a "Rig"; wasd-controls are removed-->
       <a-entity id="rig"
        movement-controls="constrainToNavMesh: true">
            <a-entity
            id="camera"
            camera
            look-controls
            twoway-motion="speed: 35"
            position="0 1.6 0"
            cursor="rayOrigin: mouse"
            circles-interactive-object
            raycaster="objects: .interactive; far: 20; interval: 100"
          >
      
        </a-entity>
       </a-entity>


      <!-- hand ctrls -->
      <a-entity id="left-hand" oculus-touch-controls="hand: left" blink-controls></a-entity>
      <a-entity id="right-hand" oculus-touch-controls="hand: right"></a-entity>

      <!--SKY BOX-->
      <a-entity
        id="sky-box"
        geometry="primitive:sphere; radius:100"
        position="0 -50 0"
        material="src: #sky_map; side:back; shader:flat"
      >
        <!--Use "side" property to load material on the inside/outside of the faces-->
      </a-entity>


      

      <!--Minimal Room Plates-->
      <a-entity id="orb_plates">      
          <a-cylinder id="minimal_plate1"
            position="-21.674 1.3 3.824"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="minimal interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="minimal_plate2"
            position="-23.487 1.3 7.649"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="minimal interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="minimal_plate3"
            position="-22.633 1.3 11.778"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="minimal interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="minimal_plate4"
            position="-19.588 1.3 14.682"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="minimal interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="minimal_plate5"
            position="-15.399 1.3 15.177"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="minimal interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="minimal_plate6"
            position="-11.753 1.3 13.206"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="minimal interactive"
            theme-select="">
          </a-cylinder>

          <!--Playground Room Plates-->
          <a-cylinder id="playground_plate1"
            position="-12.588 1.3 -21.741"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="playground interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="playground_plate2"
            position="-16.451 1.3 -23.558"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="playground interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="playground_plate3"
            position="-20.568 1.3 -22.873"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="playground interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="playground_plate4"
            position="-23.594 1.3 -19.790"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="playground interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="playground_plate5"
            position="-24.057 1.3 -15.573"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="playground interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="playground_plate6"
            position="-21.980 1.3 -11.877"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="playground interactive"
            theme-select="">
          </a-cylinder>

          <!--Liminal Room Plates-->
          <a-cylinder id="liminal_plate1"
            position="15.352 1.3 -11.735"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="liminal interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="liminal_plate2"
            position="17.599 1.3 -15.557"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="liminal interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="liminal_plate3"
            position="17.004 1.3 -19.682"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="liminal interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="liminal_plate4"
            position="14.153 1.3 -22.798"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="liminal interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="liminal_plate5"
            position="9.988 1.3 -23.548"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="liminal interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="liminal_plate6"
            position="6.175 1.3 -21.870"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="liminal interactive"
            theme-select="">
          </a-cylinder>

          <!--Nature Room Plates-->
          <a-cylinder id="nature_plate1"
            position="5.222 1.3 13.126"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="nature interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="nature_plate2"
            position="8.822 1.3 15.285"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="nature interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="nature_plate3"
            position="13.175 1.3 14.811"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="nature interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="nature_plate4"
            position="16.227 1.3 11.889"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="nature interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="nature_plate5"
            position="17.133 1.3 7.816"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="nature interactive"
            theme-select="">
          </a-cylinder>

          <a-cylinder id="nature_plate6"
            position="15.188 1.3 3.938"
            height="0.1"
            radius="0.5"
            material="color: #e74c3c"
            circles-interactive-object
            plate-interaction
            class="nature interactive"
            theme-select="">
          </a-cylinder>
      </a-entity>

      <a-entity id="keepsake_Lobby" position="14 0 14" rotation="0 180 0">
        <!--Chairs-->
        <a-entity
          id="chair1"
          position="16.569 0.1 11.148"
          rotation="0 45 0"
          scale="0.23 0.23 0.23"
          gltf-model="#chair-model"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>

        <a-entity
          id="chair2"
          position="18.809 0.1 10.646"
          rotation="0 -45 0"
          scale="0.23 0.23 0.23"
          gltf-model="#chair-model"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>

        <a-entity
          id="chair3"
          position="12.000 0.1 27.760"
          rotation="0 135 0"
          scale="0.23 0.23 0.23"
          gltf-model="#chair-model"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>

        <a-entity
          id="chair4"
          position="13.900 0.1 26.528"
          rotation="0 -135 0"
          scale="0.23 0.23 0.23"
          gltf-model="#chair-model"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>

        <a-entity
          id="chair5"
          position="20.429 0.1 26.648"
          rotation="0 135 0"
          scale="0.23 0.23 0.23"
          gltf-model="#chair-model"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>

        <a-entity
          id="chair6"
          position="22.726 0.1 26.844"
          rotation="0 -135 0"
          scale="0.23 0.23 0.23"
          gltf-model="#chair-model"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>

        <!--Table-->
        <a-entity
          id="table1"
          position="7.336 0.1 12.669"
          rotation="0 -45 0"
          scale="0.23 0.23 0.23"
          gltf-model="#table-model"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>

        <a-entity
          id="table2"
          position="6.865 0.1 23.586"
          rotation="0 45 0"
          scale="0.23 0.23 0.23"
          gltf-model="#table-model"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>

        <a-entity
          id="table3"
          position="26.083 0.1 13.727"
          rotation="0 45 0"
          scale="0.23 0.23 0.23"
          gltf-model="#table-model"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>

        <a-entity
          id="table4"
          position="26.807 0.1 22.586"
          rotation="0 -45 0"
          scale="0.23 0.23 0.23"
          gltf-model="#table-model"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>

        <!--Computers-->
        <a-entity
          id="computer1"
          position="27.021 1 13.318"
          rotation="0 -45.200 0"
          scale="0.07 0.07 0.07"
          gltf-model="#computer-minimal"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>

        <a-entity
          id="computer2"
          position="27.185 1 23.504"
          rotation="0 -135 0"
          scale="0.07 0.07 0.07"
          gltf-model="#computer-playground"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>
        <a-entity
          id="computer3"
          position="7.574 1 23.451"
          rotation="0 135 0"
          scale="0.07 0.07 0.07"
          gltf-model="#computer-liminal"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>
        <a-entity
          id="computer4"
          position="7.335 1 13.251"
          rotation="0 46.064 0"
          scale="0.07 0.07 0.07"
          gltf-model="#computer-nature"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>

        <!--Receptionist Desk-->
        <a-entity
          id="receptionistDesk"
          position="17.266 0.1 21.676"
          rotation="0 0 0"
          scale="0.307 0.307 0.307"
          gltf-model="#reception-desk-model"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>

        <a-entity
          id="receptionist"
          position="17.360 0.042 19.972"
          rotation="0 -170.433 0"
          scale="0.391 0.391 0.391"
          gltf-model="#receptionist"
          shadow="cast:true; receive:true"
          visible="true"
        >
        </a-entity>

        <!--Speech Bubble Tutorial-->
        <a-entity
          id="speechBubble"
          class="interactive"
          position="15.196 1.536 19.870"
          rotation="0 90 0"
          scale="0.4 0.4 0.4"
          gltf-model="#speech-bubble"
          shadow="cast:true; receive:true"
          visible="true"
          tutorial=""
        >
          <a-entity id="instructions"
              text="value:Welcome to Keepsake! The future of memory preservation in virtual reality.\n\nIf this is your first visit, click here for a tutorial.;
              color:black;
              font:roboto;
              width:4.5;
              anchor:left;
              baseline:top;
              wrapCount:25;"
              position="0 4.0 2.097"
              rotation="0 90 0"
          >
          </a-entity>
          <a-entity id="instructions-next"
              text="value:(Click for next);        
              color:black;
              font:roboto;
              width:4.5;
              anchor:center;
              baseline:top;
              wrapCount:25;"
              position="0 1.465 -1.155"
              rotation="0 90 0"
          >
      </a-entity>

        </a-entity>

        <!--Lobby Model-->
        <a-entity
          id="orb-room"
          position="0 0 0"
          rotation="0 0 0"
          scale="0.3 0.3 0.3"
          gltf-model="#orb-room-model"
          shadow="recieve:true;"
        >
        </a-entity>

        <!--Lobby NavMesh-->
        <a-entity
          id="lobby-nav-mesh"
          position="0 0 0"
          scale="1.0 1.0 1.0"
          gltf-model="#lobby-navmesh"
          nav-mesh
          visible="false"
        >
        </a-entity>

      </a-entity>
    </a-scene>

    <!-- Circles' end scripts [REQUIRED] -->
    <circles-end-scripts />
  </body>
</html>
